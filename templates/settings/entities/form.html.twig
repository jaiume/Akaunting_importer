{% extends "base.html.twig" %}

{% block title %}{{ mode == 'create' ? 'Add' : 'Edit' }} Entity - Settings - Akaunting Importer{% endblock %}

{% block content %}
<div class="row">
    <div class="col-12">
        <nav aria-label="breadcrumb">
            <ol class="breadcrumb">
                <li class="breadcrumb-item"><a href="{{ base_url }}dashboard">Dashboard</a></li>
                <li class="breadcrumb-item"><a href="{{ base_url }}settings">Settings</a></li>
                <li class="breadcrumb-item"><a href="{{ base_url }}settings/entities">Entities</a></li>
                <li class="breadcrumb-item active">{{ mode == 'create' ? 'Add' : 'Edit' }}</li>
            </ol>
        </nav>
        
        <h1 class="mb-4">
            <i class="bi bi-{{ mode == 'create' ? 'plus-lg' : 'pencil' }}"></i> 
            {{ mode == 'create' ? 'Add New Entity' : 'Edit Entity' }}
        </h1>
        
        {% if error %}
        <div class="alert alert-danger alert-dismissible fade show" role="alert">
            {% if error == 'name_required' %}
                <i class="bi bi-exclamation-triangle"></i> Entity name is required.
            {% elseif error == 'exists' %}
                <i class="bi bi-exclamation-triangle"></i> An entity with this name already exists.
            {% elseif error == 'failed' %}
                <i class="bi bi-exclamation-triangle"></i> Failed to save entity. Please try again.
            {% else %}
                <i class="bi bi-exclamation-triangle"></i> {{ error }}
            {% endif %}
            <button type="button" class="btn-close" data-bs-dismiss="alert"></button>
        </div>
        {% endif %}
        
        <div class="row">
            <div class="col-lg-8">
                <div class="card">
                    <div class="card-body">
                        <form method="POST" action="{{ base_url }}settings/entities/{% if mode == 'edit' %}{{ entity.entity_id }}/edit{% else %}create{% endif %}">
                            <div class="mb-3">
                                <label for="entity_name" class="form-label">Entity Name <span class="text-danger">*</span></label>
                                <input type="text" 
                                       class="form-control" 
                                       id="entity_name" 
                                       name="entity_name" 
                                       value="{{ entity.entity_name ?? '' }}"
                                       required 
                                       placeholder="e.g., Personal, ABC Company Ltd.">
                                <small class="form-text text-muted">A unique name for this entity (company or personal account).</small>
                            </div>
                            
                            <div class="mb-3">
                                <label for="description" class="form-label">Description</label>
                                <textarea class="form-control" 
                                          id="description" 
                                          name="description" 
                                          rows="3" 
                                          placeholder="Optional description...">{{ entity.description ?? '' }}</textarea>
                                <small class="form-text text-muted">Additional details about this entity (optional).</small>
                            </div>
                            
                            <div class="d-flex gap-2">
                                <button type="submit" class="btn btn-primary">
                                    <i class="bi bi-check-lg"></i> {{ mode == 'create' ? 'Create Entity' : 'Save Changes' }}
                                </button>
                                <a href="{{ base_url }}settings/entities" class="btn btn-outline-secondary">
                                    <i class="bi bi-x-lg"></i> Cancel
                                </a>
                            </div>
                        </form>
                    </div>
                </div>
            </div>
            
            <div class="col-lg-4">
                <div class="card">
                    <div class="card-header">
                        <h5 class="mb-0"><i class="bi bi-info-circle"></i> Help</h5>
                    </div>
                    <div class="card-body">
                        <p><strong>What is an Entity?</strong></p>
                        <p class="text-muted">An entity represents a real-world business or personal context that owns bank accounts. For example:</p>
                        <ul class="text-muted">
                            <li><strong>Personal</strong> - Your personal finances</li>
                            <li><strong>ABC Company Ltd.</strong> - A business you own</li>
                            <li><strong>XYZ Holdings</strong> - Another business</li>
                        </ul>
                        <p class="text-muted mb-0">Each entity can have multiple bank accounts associated with it.</p>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
{% endblock %}







